<!DOCTYPE html>

<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="initial-scale=1, shrink-to-fit=no, width=device-width" name="viewport">
    <meta name=description content="SoDoPE (Solubility Designer of Protein Expression): Optimise your protein (coding) sequences using a smarter algorithm!">
    <meta name=author content="Bikash Kumar Bhandari, Chun Shem Lim, Paul P Gardner">
    <meta name=theme-color content=#355664 />
    <meta name=keywords content="RNA, protein, protein domains, gene optimisation, PCR, simulated annealing, translation initiation, accessibility, opening energy, PSI Biology, Protein Structure Initiative, recombinant protein expression, heterelogous protein expression, E coli, Escherichia coli, Pichia pastoris, MBIE, Ministry of Business Innovation and Employment, Callaghan Innovation, UTR, promoter, mRNA">
    <meta name="google-site-verification" content="hZjxk7-ZjGgAyU5T6EbNunCaKL_gYwXerOs368wozvA" />
    <title>SoDoPE: Soluble Domain for Protein Expression</title>
    <link rel=icon href=static/images/favicon.png type=image/png sizes=16x16 />


    <meta property="og:locale", content="en_NZ" />
    <meta property="og:title", content="SoDoPE: Soluble Domain for Protein Expression" />
    <meta property="og:description", content="Optimise the solubility of your protein sequences using smarter tools and algorithms!" />
    <meta property="og:image", content="https://tisigner.otago.ac.nz/static/images/sodope_og.png" />

    <meta property="twitter:card", content="summary" />
    <meta property="twitter:title", content="SoDoPE: Soluble Domain for Protein Expression" />
    <meta property="twitter:description", content="Optimise the solubility of your protein sequences using smarter tools and algorithms!" />
    <meta property="twitter:image", content="https://tisigner.otago.ac.nz/static/images/sodope_og.jpg" />


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153760535-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-153760535-1');
</script>




    <!-- CSS -->
    <!-- Add Material font (Roboto) and Material icon as needed -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i|Roboto+Mono:300,400,700|Roboto+Slab:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Add Material CSS, replace Bootstrap CSS -->
    <link href="static/css/material/material.min.css" rel="stylesheet">
    <link href="static/css/waves/waves.min.css" rel="stylesheet">
    <link href="static/css/nouislider/nouislider.css" rel="stylesheet">
    <link href="static/css/sodope/sodope.css" rel="stylesheet">

</head>

<body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <!-- Then Material JavaScript on top of Bootstrap JavaScript -->
    <script src="static/js/material/material.min.js"></script>
    <script src="static/js/waves/waves.min.js"></script>
    <script src="static/js/tisigner/tisigner.js"></script>
    <script src="static/js/sodope/sodope.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src=https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js> </script> <script src=https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.min.js> </script> <script src="static/js/nouislider/nouislider.min.js"></script>
    <script src="static/js/nouislider/wNumb.js"></script>

    <nav class="navbar navbar-dark navbar-fixed-top" style="background-color: #355664;">
        <a class="navbar-brand" href="/">
            <span class="font-weight-bold">TI</span><span class="font-weight-bold" style="color:#EDA604">signer</span>
        </a>
        <a class="btn btn-flat-light" data-toggle=modal href=#quick-help-modal id='faq-btn'>FAQ
            <i class="material-icons">help</i></a>
    </nav>

    <div aria-hidden=true aria-labelledby=quick-help-modal-label class="modal fade" id=quick-help-modal role=dialog tabindex=-1>
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class=modal-content>
                <div class=modal-header>
                    <h2 class=modal-title id=quick-help-modal-label>Frequently asked questions</h2>
                    <button aria-label=Close class="close material-icons" data-dismiss=modal type=button>close</button>
                </div>
                <div class=modal-body>
                    <!--FAQ here -->

                    <h3 class="mt-4 typography-body-2">What should I do after submitting a sequence?</h3>
                    <p>Please click on a protein domain shown in blue. You may wish to explore solubility by adjusting the boundaries using the slider. All the domains intersected with the slider will be highlighted.</p>

                    <h3 class="mt-4 typography-body-2">How do you predict protein domains?</h3>
                    <p>SoDoPE sends a query to the HMMER web server to annotate protein domains (<a href="https://www.ebi.ac.uk/Tools/hmmer/" target="_blank">https://www.ebi.ac.uk/Tools/hmmer/ </a>). We also provide a link to the HMMER results page.</p> <h3 class="mt-4 typography-body-2">What if no known domains are found?</h3>
                            <p>SoDoPE analysis report for the full-length input sequence will be displayed. Profile plot (see below) may be useful in this case. </p>

                            <h3 class="mt-4 typography-body-2">What is the profile plot?</h3>
            <p>Profile plot shows the flexibility and hydrophobicity profiles of the selected region, which are calculated using a sliding window of 9 amino acid residues. Flexibility is calculated using a weighted variation in normalised B-factors <cite title="Improved amino acid flexibility parameters.">(Vihinen et al., 1994)</cite>, whereas hydrophobicity is calculated using a linear variation in hydropathicity <cite title="A simple method for displaying the hydropathic character of a protein.">(Kyte and Doolittle, 1982)</cite>.</p>

                            <h3 class="mt-4 typography-body-2">Why the flexibility profile appears as a straight line?</h3>
                            <p>Flexibility has a narrow range compared to hydrophobicity. If you wish to view the flexibility profile, please hide the hydrophobicity profile by clicking on its legend.</p>

                            <h3 class="mt-4 typography-body-2">How can I save the plots?</h3>
                            <p>If you wish to save or interact with the plots, please place your mouse over a plot, a toolbar will appear above the plot for you.</p>

                            <h3 class="mt-4 typography-body-2">How do you predict protein solubility?</h3>
                            <p>We used a set of 20 values for the standard amino acid residues to score protein solubility. These values were derived from the normalised B-factors <cite title="Improved amino acid flexibility parameters.">(Smith et al., 2003)</cite> using the Nelder-Mead simplex algorithm. We call the solubility score as the Solubility-Weighted Index (SWI).</p>

                            <h3 class="mt-4 typography-body-2">How do I improve the solubility of a protein domain?</h3>
                            <p>Click on ‘suggested regions’ or ‘add solubility tags’. If you wish to use a different fusion tag, please use ‘Sequence for custom tag’ and choose a sequence type.</p>

                            <h3 class="mt-4 typography-body-2">How is SoDoPE different from other protein solubility prediction tools?</h3>
                            <p>SoDoPE uses only one feature (SWI) to prediction solubility. This key feature outperforms many existing tools. SoDoPE streamlines the process of designing protein sequences for tuning expression (see below) and solubility.</p>

                            <h3 class="mt-4 typography-body-2">What is ‘optimise expression’ about?</h3>
                            <p>This is an option for optimising protein expression using our TIsigner web app.</p>

                            <h3 class="mt-4 typography-body-2">How to cite SoDoPE?</h3>
                            <p>Bikash K Bhandari, Paul P Gardner, Chun Shen Lim. (2019) <cite title="Protein solubility is controlled by global structural flexibility.">Protein solubility is controlled by global structural flexibility</cite>. BioRxiv. DOI: </p>
                            <p>If you find optimising protein expression useful, please also cite the following preprint:
                                Bikash K Bhandari, Chun Shen Lim, Paul P Gardner. (2019) <cite title="Highly accessible translation initiation sites are predictive of successful heterologous protein expression.">Highly accessible translation initiation sites are predictive of successful heterologous protein expression</cite>. BioRxiv. <a href=https://doi.org/10.1101/726752>DOI:10.1101/726752 </a> </p> <h3 class="mt-4 typography-body-2">Could I copy and distribute SoDoPE for commercial purposes?</h3>
                                    <p>
                                        Feel free to do so under following terms and conditions:
                                        <p class="text-monospace">Disclaimer and Copyright
                                            <br><br>The programs and source code of SoDoPE are free software. They are distributed in the hope that they will be useful but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Permission is granted for research, educational, and commercial use and modification so long as:
                                            <ol class="text-monospace">
                                                <li>The package and any derived works are not redistributed for any fee, other than media costs.</li>
                                                <li>Proper credit is given to the authors.</li>
                                            </ol>
                                            <span class="text-monospace">If you want to include this software in a commercial product, please contact the authors.</span>
                                        </p>
                                    </p>

                                    <h3 class="mt-4 typography-body-2">References</h3>
                                    <ul class="list-unstyled">
                                        <li>Kyte,J. and Doolittle,R.F. (1982) <cite title="A simple method for displaying the hydropathic character of a protein.">A simple method for displaying the hydropathic character of a protein.</cite>H J. Mol. Biol., 157, 105–132.</li>
                                        <li>Smith,D.K. et al. (2003) <cite title="Improved amino acid flexibility parameters.">Improved amino acid flexibility parameters</cite> Protein Sci., 12, 1060–1072.</li>
                                        <li>Vihinen,M. et al. (1994) <cite title="Accuracy of protein flexibility predictions.">Accuracy of protein flexibility predictions.</cite> Proteins: Structure, Function, and Genetics, 19, 141–149.</li>

                                        <!--FAQ end -->

                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                        </div>
                </div>
            </div>
        </div>
    </div>
    <main>
        <div class="container-fluid" style="padding: 40px;">
            <div class="p-5 mb-5">
                <div class="col-auto " id="main-contents">

                    <!--initial page-->
                    <div id="banner" class="collapse show">
                        <div class="text-center">
                            <img src="static/images/sodope.png" class="img-fluid" alt="Solubility Designer of Protein Expression" style="max-width: 40%;">
                        </div>
                        <div class="p-4 mb-8" id="input-form-div">

                            <div class="d-flex justify-content-center">
                                <div class="form-check form-check-inline">
                                    <div class="form-group row">
                                        <div class="custom-control custom-radio custom-control-inline">
                                            <input type="radio" id="protein" name="type-of-seq" class="custom-control-input" value="protein" autocomplete="off">
                                            <label class="custom-control-label" for="protein">Amino acid sequence</label>
                                        </div>

                                        <div class="custom-control custom-radio custom-control-inline">
                                            <input type="radio" id="nucleotide" name="type-of-seq" class="custom-control-input" value="nucleotide" autocomplete="off">
                                            <label class="custom-control-label" for="nucleotide">Nucleotide sequence</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="collapse hide" id="input-help">
                                <div class="d-flex justify-content-center">
                                    <div class="alert alert-light shadow-1" role="alert" id="input-help-text">
                                    </div>
                                </div>
                            </div>

                            <form id="input-form-pfam" action="https://www.ebi.ac.uk/Tools/hmmer/search/hmmscan" method="post">

                                <div class=floating-label>
                                    <label>Sequence</label>
                                    <textarea input aria-describedby=input-sequence-help class="form-control custom-sol-inp" id="seq-input" placeholder="" type="text" rows=1 spellcheck=false required></textarea>
                                    <div class="invalid-feedback" id="seq-validation">

                                    </div>
                                </div>

                                <div class=form-group>
                                    <div class="collapse">
                                        <textarea input aria-describedby=input-sequence-help class="form-control" id="seq" placeholder="Standard one letter amino acid symbols only" type="text" name="seq" rows=1 spellcheck=false></textarea>
                                    </div>
                                    <div class="collapse">
                                        <textarea input name="hmmdb">pfam</textarea>
                                    </div>
                                    <div class="collapse">
                                        <textarea input aria-describedby=input-sequence-help class="form-control" id="nt-seq" placeholder="Nucleotide sequence" type="text" rows=1 spellcheck=false></textarea>
                                    </div>
                                    <br>
                                    <div class="d-flex justify-content-center">
                                        <button class="btn btn-dark" type="submit" id="submit-btn-pfam">Submit</button>
                                    </div>
                                    <script type=text/javascript> var frm=$('#input-form-pfam'); frm.submit(function(e) { if( validateInput(e)){ e.preventDefault(); afterSubmit(); $.ajax({ type: frm.attr('method'), url: frm.attr('action'), data: frm.serialize(), dataType: 'json' , success: function(data, status, jqXHR) { $('#pbar').css("width", "5%" ); hmmerParse(data, status); }, error: function(data) { console.log('An error occurred.'); console.log(data); allError(data); }, }); } e.preventDefault(); }); </script> </div> </form> </div> </div> <!-- initial page end-->

                                        <!--                    progress page-->
                                        <div class="col-xl" id="progress-page">
                                            <div id="progress-console" class="collapse hide">
                                                <div class="card text-left shadow-4">
                                                    <div class="card-header">
                                                        Progress
                                                    </div>
                                                    <div class="card-body" id="console-body">
                                                        <span class="text-monospace">Querying HMMER...</span>
                                                    </div>

                                                    <div class="card-footer">
                                                        <div class="progress">
                                                            <div class="progress-bar " role="progressbar" style="width: 0%" id="pbar"></div>
                                                        </div>
                                                        <p>
                                                            <div class="d-flex">
                                                                <div class="collapse hide" id="continue-btn-console">
                                                                    <a href="#" class="btn btn-outline-warning" onclick="showDomains();">Continue without domain identification</a>
                                                                </div>
                                                                <div class="collapse hide" id="retry-btn-console">
                                                                    <a href="#" class="btn btn-outline-danger" onclick="location.reload(true);">Retry</a>
                                                                </div>
                                                            </div>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--                progress page end-->
                                        <br>

                                        <!--                results page-->
                                        <div class="collapse hide" id="results-page">

                                            <div class="row">
                                                <div class="col">

                                                    <div class="card text-left shadow-4">
                                                        <!--
                                    <div class="card-header">
                                        Solubility analysis
                                    </div>
-->
                                                        <div class="card-body">
                                                            <h5 class="card-title">Click on a domain</h5>
                                                            <p class="text-muted" id="visualise-msg">Visualise on <a id="full-result-link" target="_blank" href="#">HMMER</a>.
                                                                <div id="residue-line"></div>
                                                                <div id="badge-pills"></div>
                                                                <br>
                                                                <br>
                                                                <form id="domain-slider" class="collapse hide">
                                                                    <br>
                                                                    <div id="range-input"></div>

                                                                    <br>
                                                                    <p>
                                                                        <div class="form-inline mb3">
                                                                            <div class="input-group mb-2 mr-sm-2">
                                                                                <a class="btn btn-light" data-toggle="collapse" href="#manual-input" role="button" aria-expanded="false" aria-controls="collapseManualRegions">
                                                                                    Custom positions
                                                                                </a>
                                                                            </div>

                                                                            <div class="input-group mb-2 mr-sm-2">
                                                                                <div class="btn-group" data-toggle="buttons" role="group">
                                                                                    <a class="btn btn-light" data-toggle="collapse" href="#regionSuggestions" role="button" aria-expanded="false" aria-controls="collapseManualRegions">
                                                                                        Suggested regions <span class="badge badge-primary" id="numSuggReg"></span>
                                                                                    </a>
                                                                                    <a tabindex="0" class="btn btn-light" data-toggle="popover" data-trigger="click" data-html="true" title="Settings" id="suggestion-popover" data-content="<form><label for='sugg-settings'>Number of residues to extend the boundaries. Maximum 200 residues. </label><input type='number' class='form-control' id='sugg-settings-popover' onkeypress='return event.charCode>=48&&event.charCode<=57' /><small id='suggestionHelp' class='form-text text-muted'>Please save your settings.</small><div class='invalid-feedback'>Enter number between 2 to 200 only!</div><br><a class='btn btn-light' onclick='popOverValueSave()'>Save</a></form>"><i class="material-icons">tune</i>
                                                                                    </a>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </p>
                                                                    <div class="collapse" id="manual-input">
                                                                        <div class="form-row">
                                                                            <div class="col col-md-2">
                                                                                <label>Start</label>
                                                                                <input type="number" class="form-control" placeholder="Start" rows=1 id="start-box" value=1 onkeypress="return event.charCode>=48&&event.charCode<=57">
                                                                            </div>
                                                                            <div class="col col-md-2">
                                                                                <label>End</label>
                                                                                <input type="number" class="form-control" placeholder="End" rows=1 id="end-box" value=15 onkeypress="return event.charCode>=48&&event.charCode<=57">
                                                                            </div>

                                                                            <div class="col col-md-2 collapse hide">
                                                                                <label>Number of residues to extend the region</label>
                                                                                <input <input type="number" class="form-control" placeholder="End" rows=1 id="sugg-settings" value=50 onkeypress="return event.charCode>=48&&event.charCode<=57">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </form>

                                                                <p>
                                                                    <div class="collapse" id="regionSuggestions">
                                                                        <!-- <a tabindex="0" class="btn btn-outline" data-toggle="popover" data-trigger="click" data-html="true" title="Settings for suggestions" id="suggestion-popover" data-content="<form ><label for='sugg-settings'>Number of residues to extend the region</label><small id='suggestionHelp' class='form-text text-muted'>Max 200.</small><input type='number' class='form-control' id='sugg-settings' value=50 /><br><a class='btn btn-light' onclick='$(&quot;#suggestion-popover&quot;).popover(&quot;hide&quot;);'><i class='material-icons'>done</i></a></form>"><i class="material-icons">build</i></a>text -->
                                                                    </div>
                                                                </p>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>
                                            <br>
                                            <br>
                                            <div class="row">
                                                <div class="col collapse hide" id="result-card">
                                                    <div class="card shadow-4" id="card-results">
                                                        <div class="card-body" id="results-card-body" style="overflow:auto;">
                                                            <h5 class="card-title">
                                                                Results:
                                                            </h5>


                                                            <div class="form-inline mb3">
                                                                <div class="input-group ">
                                                                    <label for="proba">Probability of solubility</label>
                                                                    <input type="text" id="proba" readonly class="form-control-plaintext mb-2 mr-sm-2" rows=1 style="resize:none"></input>
                                                                </div>

                                                                <div class="input-group ">
                                                                    <label for="flex-res">Flexibility</label>
                                                                    <input type="text" id="flex-res" readonly class="form-control-plaintext mb-2 mr-sm-2" rows=1 style="resize:none"></input>
                                                                </div>

                                                                <div class="input-group">
                                                                    <label for="gravy-res">GRAVY</label>
                                                                    <input type="text" id="gravy-res" readonly class="form-control-plaintext mb-2 mr-sm-2" rows=1 style="resize:none"></input>
                                                                </div>


                                                            </div>

                                                            <hr>
                                                            <div class="form-inline mb3">


                                                                <div class="input-group mb-3 mr-sm-2">
                                                                    <button type="button" class="btn btn-light" data-toggle="collapse" href="#custom-tag-results" id="view-tag">
                                                                        Add solubility tags
                                                                    </button>
                                                                </div>


                                                                <div class="input-group mb-3 mr-sm-2">
                                                                    <a class="btn btn-light" data-toggle="collapse" href="#graph" role="button" aria-expanded="false" aria-contorols="ShowGraph">
                                                                        Profile plot
                                                                    </a>
                                                                </div>

                                                            </div>



                                                        <div class="form-inline mb3">
                                                            <div class="input-group mb-5 mr-sm-2">
                                                            <div class="collapse hide" id="custom-tag-results">
<!--                                                                <hr>-->

                                                                <div class="input-group mb-2 mr-sm-2">
                                                                    <div class=floating-label>
                                                                        <label>Sequence for custom tag</label>
                                                                        <textarea input aria-describedby=custom-tag-help class="form-control" id="custom-tag" placeholder="" type="text" rows=1 spellcheck=false></textarea>
                                                                        <div class="invalid-feedback" id="custom-tag-invalid">

                                                                        </div>
                                                                    </div>

                                                                    <div class="d-flex justify-content-center">
                                                                        <div class="form-check form-check-inline">
                                                                            <div class="form-group row">
                                                                                <div class="custom-control custom-radio custom-control-inline">
                                                                                    <input type="radio" id="protein-tag" name="type-of-tag" class="custom-control-input" value="protein" autocomplete="off">
                                                                                    <label class="custom-control-label" for="protein-tag">Amino acid sequence</label>
                                                                                </div>

                                                                                <div class="custom-control custom-radio custom-control-inline">
                                                                                    <input type="radio" id="nucleotide-tag" name="type-of-tag" class="custom-control-input" value="nucleotide" autocomplete="off">
                                                                                    <label class="custom-control-label" for="nucleotide-tag">Nucleotide sequence</label>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <hr>
                                                                <div class="input-group mb-2 mr-sm-2">
                                                                    <div id="plotly-chart-tag"></div>
                                                                </div>
                                                                
                                                                

                                                                
                                                            </div>
                                                            </div>





                                                            <div class="input-group mb-5 mr-sm-2">
                                                            <div class="collapse hide" id="graph">
<!--                                                                <hr>-->
                                                                <div class="input-group mb-2 mr-sm-2 collapse hide">
                                                                    <div id="plotly-chart"></div>
                                                                </div>
                                                            </div>
                                                            </div>
                                                            
                                                </div>




                                                            <hr>
                                                            <div class="form-group mb-3">
                                                                <label for="result-seq">Amino acid sequence</label>
                                                                <textarea id="result-seq" readonly class="form-control-plaintext" onclick="this.focus();this.select()" style="resize:none"></textarea>
                                                                <div class="text-danger" id="no-optimisation"> </div>

                                                                <div id="result-nt" class="collapse">
                                                                    <hr>
                                                                    <label for="result-seq-nt">Nucleotide sequence</label>
                                                                    <textarea id="result-seq-nt" readonly class="form-control-plaintext" onclick="this.focus();this.select();" style="resize:none"></textarea>
                                                                </div>
                                                            </div>
                                                            <hr>

                                                            <div class="form-inline mb3">
                                                                <div class="input-group mb-2 mr-sm-2">
                                                                    <a href="#none" role="button" class="btn btn-light" id="optimise-to-tisigner">Optimise expression</a>
                                                                </div>

                                                                <div class="input-group mb-2 mr-sm-2">
                                                                    <a href="#" class="btn btn-light" onclick="location.reload(true);">New analysis</a>
                                                                </div>

                                                            </div>

                                                            <!-- &nbsp; -->
                                                            <!-- </div> -->

                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <!--result end here-->
                                            <br>
                                            <br>





                                        </div>
                                </div>
                        </div>
                        <!--            results page end-->




                        <!--            optimisation page-->


                        <div class="mb-5 collapse hide" id="optimisation-tisigner">

                            <p><button class="btn btn-primary shadow-4" id="cancel-optimisation"><i class="material-icons mr-2">arrow_back</i>sodope</button></p>
                            <div class="collapse show rounded shadow-4" id="submit-inputs">

                                <div class=card>
                                    <div class="card card-body" id="input-form-card">
                                        <div id="snackbar-msg" class="snackbar snackbar-right collapse">
                                            <div class=snackbar-body>
                                                Sequence submitted. Please wait for a moment...
                                            </div>
                                        </div>
                                        <div id="snackbar-msg-error" class="snackbar snackbar-right collapse snackbar-multiline">
                                            <div class=snackbar-body>
                                            </div>
                                        </div>
                                        <div class=collapse id=show-results>
                                            <h4 class=card-title>Results</h4>
                                            <hr>
                                            <p>Optimised sequence : </p>
                                            <table class="table table-striped table-hover table-sm" id=new-table0 style=word-break:break-all>
                                                <caption>Mismatches are highlighted.</caption>
                                                <thead>
                                                    <tr>
                                                        <th scope=col>Sequence</th>
                                                        <th scope=col style=width:100px>Opening<br>Energy</th>
                                                        <th scope=col style=width:100px>Expression<br>Score (&percnt;)</th>
                                                        <th scope=col style=width:100px>Terminator<br>Hits</th>
                                                        <th scope=col style=width:100px>E-values</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <p>Input sequence: </p>
                                            <table class="table table-striped table-hover table-sm" id=new-table1 style=word-break:break-all>
                                                <thead>
                                                    <tr>
                                                        <th scope=col>Sequence</th>
                                                        <th scope=col style=width:100px>Opening<br>Energy</th>
                                                        <th scope=col style=width:100px>Expression<br>Score (&percnt;)</th>
                                                        <th scope=col style=width:100px>Terminator<br>Hits</th>
                                                        <th scope=col style=width:100px>E-values</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <button type="button" class="btn btn-outline-dark" data-toggle=collapse href=#extra-results id=show-more>Show more</button>
                                            <div class="collapse" id=extra-results>
                                                <p>Other optimised sequences:</p>
                                                <table class="table table-striped table-hover table-sm" id=new-table2 style=word-break:break-all>
                                                    <caption>Mismatches are highlighted.</caption>
                                                    <thead>
                                                        <tr>
                                                            <th scope=col>Sequence</th>
                                                            <th scope=col style=width:100px>Opening<br>Energy</th>
                                                            <th scope=col style=width:100px>Expression<br>Score (&percnt;)</th>
                                                            <th scope=col style=width:100px>Terminator<br>Hits</th>
                                                            <th scope=col style=width:100px>E-values</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class=container>
                                                <canvas id=myChart></canvas>
                                            </div>
                                            <div class=modal-footer>
                                                <a id=try-again class="btn btn-outline-dark"><i class="material-icons mr-2">refresh</i>Reoptimise</a>
                                            </div>
                                        </div>

                                        <div id="tisigner-form-div" class="collapse hide">
                                            <form id="input-form" action="/optimise" method=post>
                                                <input type=hidden name=csrf_token value="{{ csrf_token() }}" />
                                                <nav>
                                                    <div class="nav nav-tabs" id=nav-tab role=tablist>
                                                        <a class="nav-item nav-link active" id=nav-input-tab data-toggle=tab href=#nav-input role=tab aria-controls=nav-input aria-selected=true>Input</a>
                                                        <a class="nav-item nav-link" id=nav-settings-tab data-toggle=tab href=#nav-settings role=tab aria-controls=nav-settings aria-selected=false>Customise</a>
                                                        <!--                                                <a class="nav-item nav-link" id=demo href=#nav-demo>Example</a>-->
                                                    </div>
                                                </nav>
                                                <div class=tab-content id=nav-tabContent>
                                                    <div class="tab-pane fade show active" id=nav-input role=tabpanel aria-labelledby=nav-input-tab>
                                                        <br>
                                                        <div class=form-group>
                                                            <label for=host-select>Host</label>
                                                            <select class=form-control id=host-select name=host-select onclick=hostSelect() required>
                                                                <option label></option>
                                                                <option>Escherichia coli</option>
                                                                <option>Saccharomyces cerevisiae</option>
                                                                <option>Mus musculus</option>
                                                                <option>Other</option>
                                                            </select>
                                                            <small id=host-help class="form-text text-muted">Your input sequence will be optimised for this host.</small>
                                                        </div>
                                                        <div class=form-group>
                                                            <div class=floating-label>
                                                                <label for=input-sequence>Input sequence</label>
                                                                <textarea input aria-describedby=input-sequence-help class=form-control id=input-sequence placeholder type=text name=input-sequence rows=1 spellcheck=false pattern=[CAGTUcagtu]+$ required></textarea>
                                                                <small id=input-sequence-help class="form-text text-muted">A protein coding sequence (DNA or RNA).</small>
                                                            </div>
                                                        </div>
                                                        <div class=form-group>
                                                            <div class=floating-label>
                                                                <label for=utr>5&prime; UTR (Promoter)</label>
                                                                <select class=form-control id=utr name=utr required>
                                                                    <option label></option>
                                                                    <option value=1>T7lac promoter (e.g., pET21)</option>
                                                                    <option value=3>Custom</option>
                                                                </select>
                                                                <small id=utr-help class="form-text text-muted">Pick a promoter or input your custom sequence. </small>
                                                            </div>
                                                        </div>
                                                        <div class="form-group collapse" id=cst-utr>
                                                            <div class=floating-label>
                                                                <label for=custom-utr>Input 5&prime; UTR sequence</label>
                                                                <textarea input aria-describedby=custom-utr-help class=form-control id=custom-utr placeholder type=text name=custom-utr rows=1 spellcheck=false></textarea>
                                                                <small id=custom-utr-help class="form-text text-muted">A custom 5&prime; UTR sequence.</small>
                                                            </div>
                                                        </div>
                                                        <div class="form-group collapse hide" id="optimisation-type">
                                                            <label for=customRadioInline0>Optimisation type</label>
                                                            <div class="custom-control custom-radio custom-control-inline">
                                                                <input type=radio id=optimisation-direction0 name=optimisation-direction class="custom-control-input form-check-input" checked value='decrease'>
                                                                <label class="custom-control-label form-check-label" for=optimisation-direction0>Maximise Expression</label>
                                                            </div>
                                                            <div class="custom-control custom-radio custom-control-inline">
                                                                <input type=radio id=optimisation-direction1 name=optimisation-direction class=custom-control-input value="increase">
                                                                <label class="custom-control-label form-check-label" for=optimisation-direction1>Minimise Expression</label>
                                                            </div>
                                                        </div>
                                                        <p></p>
                                                        <div class="form-group collapse hide" id=lvl-selection-slider>
                                                            <div class=form-row>
                                                                <div class="form-group col-sm-10">
                                                                    <label for=lvl-tune>Your target Expression Score (&percnt;)</label>
                                                                    <input type=range class=custom-range min=5 max=100 step=5 id=lvl-tune oninput=updateTuning(this) value=100>
                                                                    <small class="form-text text-muted">The optimised sequence will have scores close to this value. </small>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <input type=text class="form-control-plaintext col-sm-10" id=lvl-tune-val value="High (100%)" readonly>
                                                                </div>
                                                            </div>
                                                            <textarea input aria-describedby=fine-tune-expression class="form-control d-none" id=lvl-tune-val-txt name=lvl-tune-val-txt rows=1 spellcheck=false value=100></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="tab-pane fade" id=nav-settings role=tabpanel aria-labelledby=navigation-settings-tab>
                                                        <br>
                                                        <div class=form-group>
                                                            <label for=customRadioInline1>Synonymous codon substitution</label>
                                                            <div class="custom-control custom-radio custom-control-inline">
                                                                <input type=radio id=primer-button name=designMode class="custom-control-input form-check-input" checked value=10 onclick=ntSlider()>
                                                                <label class="custom-control-label form-check-label" for=primer-button>Translation initiation coding region</label>
                                                            </div>
                                                            <div class="custom-control custom-radio custom-control-inline">
                                                                <input type=radio id=full-button name=designMode class=custom-control-input value=fullGene onclick=ntSlider()>
                                                                <label class="custom-control-label form-check-label" for=full-button>Full-length sequence</label>
                                                            </div>
                                                        </div>
                                                        <div class="form-group collapse show" id=primer-length-selection-slider>
                                                            <div class=form-row>
                                                                <div class="form-group col-sm-10">
                                                                    <label for=len-primer>Maximum number of replaceable codons</label>
                                                                    <input type=range class=custom-range min=4 max=9 id=len-primer oninput=updateRange(this) value=9>
                                                                </div>
                                                                <div class="form-group col-md-2">
                                                                    <input type=text readonly class="form-control-plaintext col-sm-10" id=len-primer-val value="First 9">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class=form-group>
                                                            <div class=floating-label>
                                                                <label for=rms-sites>Restriction sites to avoid</label>
                                                                <textarea input aria-describedby=restriction-modification-sites-help class=form-control id=rms-sites placeholder="Multiple sites can be separated by comma. For example: GAATTC,GGATTC,AAGCTT. Reverse complements are also filtered. " type=text name=rms-sites rows=1 spellcheck=false pattern=([ACGTU]+,{0,1}[AGCTU])+></textarea>
                                                                <small id=restriction-modification-sites-hel class="form-text text-muted">AarI, BsaI, BsmBI are filtered out by default.</small>
                                                            </div>
                                                        </div>
                                                        <div class="custom-control custom-switch">
                                                            <input class=custom-control-input id=advancedSwitch type=checkbox onclick=showAdvancedForm()>
                                                            <span class=custom-control-track></span>
                                                            <label class="custom-control-label text-muted" for=advancedSwitch id=advancedSwitchText>Show advanced parameters</label>
                                                        </div>
                                                        <div class="form-group collapse hide" id=algorithm-settings>
                                                            <br>
                                                            <label for=customRadioInline2>Choose a method</label>
                                                            <div class="custom-control custom-radio custom-control-inline" id=default-algorithm>
                                                                <input type=radio id=algo-options-quick name=algochoose class="custom-control-input form-check-input" value=quick checked>
                                                                <label class="custom-control-label form-check-label" for=algo-options-quick>Quick Sampling</label>
                                                            </div>
                                                            <div class="custom-control custom-radio custom-control-inline" id=alt-algorithm>
                                                                <input type=radio id=algo-options-deep name=algochoose class=custom-control-input value=deep>
                                                                <label class="custom-control-label form-check-label" for=algo-options-deep>Deep Sampling</label>
                                                            </div>
                                                            <p class=text-muted>Quick Sampling is suitable for most cases. However, if you are not getting good results, try Deep Sampling.</p>
                                                            <div class="custom-control custom-checkbox">
                                                                <input type=checkbox class="custom-control-input form-check-input" id=termcheck onclick=termcheckset()>
                                                                <label class=custom-control-label for=termcheck aria-describedby=terminator-check>Terminator check</label>
                                                                <textarea input class="form-control d-none" id=termcheck-bool name=termcheck-bool rows=1 spellcheck=false value=false></textarea>
                                                            </div>
                                                            <p class=text-muted>If checked, the number of hits and E-values will also be reported.</p>
                                                            <br>

                                                            <div class="form-group" id=cst-region>
                                                                <div class=floating-label>
                                                                    <label for=custom-region>Custom region to optimise accessibility</label>
                                                                    <textarea input aria-describedby=custom-region-help class=form-control id=custom-region placeholder="Positions can be separated by a colon (:). Default regions for E. coli, S. cerevisiae, M. musculus and Other are -24:24, −7:89, -8:11 and -24:89, respectively. Maximum 150 nt and minimum 5 nt." type=text name=custom-region rows=1 spellcheck=false maxlength=7></textarea>
                                                                    <small id=custom-region-help class="form-text text-muted">Use the following guide to enter the start and end positions of your region.</small>
                                                                    <blockquote class="blockquote text-center">
                                                                        <ul class="list-unstyled">
                                                                            <li class="text-monospace text-uppercase">... <a class="text-primary">_&nbsp; </a><a class="text-secondary">_&nbsp; </a><a class="text-danger">_&nbsp; </a><a class="text-info">A </a><a class="text-success">T </a><a class="text-warning">G </a>_ _ _ ...</li>
                                                                            <li class="text-monospace">... <a class="text-primary">-3 </a><a class="text-secondary">-2 </a><a class="text-danger">-1 </a><a class="text-info">1 </a><a class="text-success">2 </a><a class="text-warning">3 </a>4 5 6 ...</li>
                                                                        </ul>
                                                                    </blockquote>
                                                                </div>
                                                            </div>
                                                            <div class=floating-label>
                                                                <label for=seed>Random seed</label>
                                                                <input type=text class="form-control mb-3" id=seed placeholder="Only numbers allowed." name=seed value=0 onkeypress='return event.charCode>=48&&event.charCode<=57' maxlength=9>
                                                                <small id=seedhelp class="form-text text-muted">This controls reproducibility of the output.</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class=collapse id=seq-err>
                                                    <div class="alert alert-warning alert-dismissible fade show" role=alert id=seq-err-msg>
                                                    </div>
                                                </div>
                                                <br>
                                                <div class=collapse id=infinite-prog-bar>
                                                    <div class=progress>
                                                        <div class="progress-bar progress-bar-indeterminate" role=progressbar></div>
                                                        <div class="progress-bar progress-bar-indeterminate bg-success" role=progressbar></div>
                                                        <div class="progress-bar progress-bar-indeterminate bg-info" role=progressbar></div>
                                                    </div>
                                                </div>
                                                <div class=modal-footer>
                                                    <button class="btn btn-outline-dark" data-toggle=collapse id=submit-btn type="submit"><i class="material-icons mr-2">play_arrow</i>Optimise</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--            optimisation page end-->

                    </div>
                </div>

                <hr>
                <div class="text-center text-muted mx-auto">
                    <div><small>SoDoPE last update date: {{mod_date|safe}}</small></div>
                </div>

            </div>

    </main>
</body>

</html>
